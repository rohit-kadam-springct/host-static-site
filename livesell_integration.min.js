(function(){function e(){Y.src=`${z}?autoJoin=true&userName=${event.data.userName}`,F.style.display="flex",document.body.style.overflow="hidden"}function t(){document.body.style.overflow=null,F.style.display="none",Y.src="",n()}function n(){B.onclick=null}function i(){B.style.userSelect="none",B.style.cursor="pointer",B.onclick=(e=>{e.stopPropagation(),e.preventDefault(),t()})}function o(e){e.action===M.CONNECT&&(te=e.roomData,Y.contentWindow.postMessage({code:e.code,dataAttributes:k},G),i())}function l(e){if(!Y.src)return;ne&&clearTimeout(ne);const t=window.document.getElementById("livesell-product-modal"),o=window.document.getElementById("livesell-product-iframe");e.action===M.OPEN?(o.src=e.url,t.style.display="flex",F.classList.add("livesell-floating-modal"),te&&te.branding.roomBackgroundColor&&(J.style.background=te.branding.roomBackgroundColor),F.style.width=`${P.width}px`,F.style.height=`${P.height}px`,Y.style.width="100%",Y.style.height="100%",F.style.bottom="10px",F.style.left="10px",e.options&&e.options.addDraggableOverlay&&d(),E(),D(),n()):(F.classList.remove("livesell-floating-modal"),F.style.width=null,F.style.height=null,F.style.top=null,F.style.bottom="0px",F.style.left="0px",Y.style.width=null,Y.style.height=null,s(),g(),S(),i(),k.keepProductVisible||(ne=setTimeout(()=>{t.style.display="none",o.src=""},H)))}function d(){K.style.display="flex",K.addEventListener("touchend",a),K.addEventListener("touchmove",m),K.addEventListener("touchstart",u)}function s(){K.style.display="none",K.removeEventListener("touchend",a),K.removeEventListener("touchmove",m),K.removeEventListener("touchstart",u)}function r(e,t){F&&(ae=F.offsetTop,ce=F.offsetLeft,ie=ce+e,oe=ae+t)}function a(){}function c(e,t){ie&&oe&&(ae+=t,ce+=e,f(ae,ce),ie+=e,oe+=t)}function u(e){e.preventDefault(),F&&(ie=e.touches[0].clientX,oe=e.touches[0].clientY,ae=F.offsetTop,ce=F.offsetLeft)}function m(e){h(e.touches[0])}function h(e){ce+=e.clientX-ie,ae+=e.clientY-oe,f(ae,ce),ie=e.clientX,oe=e.clientY}function f(e,t){const n=v(e),i=p(t);ae=n,ce=i,F.style.bottom=window.innerHeight-n-F.offsetHeight+"px",F.style.left=i+"px"}function p(e){return Math.max(Math.min(e,window.innerWidth-F.offsetWidth/2),-F.offsetWidth/2)}function v(e){return Math.max(Math.min(e,window.innerHeight-F.offsetHeight/2),-F.offsetHeight/2)}function E(){window.addEventListener("resize",y)}function g(){window.removeEventListener("resize",y)}function y(e){if(!ae||!ce)return;const t=ae*(window.innerHeight-F.offsetHeight)/(me-F.offsetHeight),n=ce*(window.innerWidth-F.offsetWidth)/(ue-F.offsetWidth);f(t,n),me=window.innerHeight,ue=window.innerWidth}function w(e){he=!0,le=e.clientX,de=e.clientY,se=F.offsetWidth,re=F.offsetHeight,ee.style.display="flex",document.addEventListener("mousemove",b),document.addEventListener("mouseup",T),Q.addEventListener("touchmove",A),Q.addEventListener("touchend",T)}function L(e){const t=se+e.clientX-le,n=t/C;x(t,n)&&(F.style.width=t+"px",F.style.height=n+"px")}function x(e,t){return e>P.minWidth&&t>P.minHeight&&e<P.maxWidth&&t<P.maxHeight&&e<window.innerWidth&&t<window.innerHeight&&e/2>-F.offsetLeft}function b(e){e.preventDefault(),L(e)}function A(e){e.preventDefault(),L(e.touches[0])}function T(e){he=!1,ee.style.display="none",document.removeEventListener("mouseup",T),document.removeEventListener("mousemove",b),Q.addEventListener("touchend",T),Q.removeEventListener("touchmove",A)}function R(e){e.preventDefault(),w(e.touches[0])}function O(e){e.preventDefault(),w(e)}function D(){Q.style.display="flex",Q.addEventListener("mousedown",O),Q.addEventListener("touchstart",R)}function S(){Q.style.display="none",Q.removeEventListener("mousedown",O),Q.removeEventListener("touchstart",R)}const C=16/9,H=1e3,U={PRODUCT_PAGE:"PRODUCT_PAGE",DRAG_START:"LIVESELL_DRAG_START",DRAG_MOUSEMOVE:"LIVESELL_DRAG_MOUSEMOVE",DRAG_END:"LIVESELL_DRAG_END",DATA_ATTRIBUTES:"LIVESELL_DATA_ATTRIBUTES"},M={OPEN:"OPEN",CLOSE:"CLOSE",CONNECT:"CONNECT"},_={MESSAGE:"message",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove",MOUSELEAVE:"mouseleave",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",RESIZE:"resize"},N={PARENT:"parent",LIVESELL:"livesell"},W=window.matchMedia("only screen and (max-width: 760px)").matches,P=W?{minWidth:160,minHeight:90,width:240,height:135,maxWidth:320,maxHeight:180}:{minWidth:240,minHeight:135,width:320,height:180,maxWidth:640,maxHeight:360},I=document.currentScript,k={meetingURL:I.getAttribute("data-livesell-url"),keepProductVisible:"false"!==I.getAttribute("data-keep-product-visible"),displayProductIframe:I.getAttribute("data-display-product-iframe")||N.PARENT};if(!k.meetingURL)return void console.error("ERROR: Please provide meeting URL in livesell integration script.");const z=k.meetingURL,G=new URL(z).origin,B=document.createElement("div");B.style.position="relative";const V=document.createElement("div");V.id="livesell-transparent-overlay",B.appendChild(V);const X=document.createElement("div");X.id="livesell-meeting-modal";const Y=document.createElement("iframe");Y.id="livesell-meeting-iframe",Y.setAttribute("allow","camera; microphone; fullscreen; autoplay"),Y.frameBorder="0",X.appendChild(Y);const $=document.createElement("div");$.id="livesell-draggable-overlay",X.appendChild($);const j=document.createElement("div");j.id="livesell-resizable-overlay",X.appendChild(j),B.appendChild(X);const J=document.createElement("div");J.id="livesell-product-modal",B.appendChild(J);const Z=document.createElement("iframe");Z.id="livesell-product-iframe",Z.style.width="100%",Z.style.height="100%",Z.style.border="none",Z.style.overflow="hidden",Z.setAttribute("allowfullscreen",""),Z.setAttribute("allow",""),Z.frameBorder="0",J.appendChild(Z),document.body.appendChild(B);const q=document.createElement("style");q.innerHTML="\n  #livesell-meeting-modal {\n  position: fixed;\n  z-index: 2147483646;\n  height: 100%;\n  width: 100vw;\n  bottom: 0px;\n  left: 0px;\n  display: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.5);\n  will-change: transform;\n}\n\n.livesell-floating-modal {\n  left: 10px;\n  bottom: 10px;\n  border-radius: 6px !important;\n  overflow: hidden !important;\n}\n\n#livesell-meeting-iframe {\n  position: relative;\n  z-index: 2147483645;\n  border-radius: 6px;\n  overflow: hidden;\n  height: calc(100% - 32px);\n  width: calc(100% - 32px);\n}\n\n#livesell-draggable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 100%;\n  width: calc(100% - 110px);\n  display: none;\n  cursor: move;\n}\n\n#livesell-resizable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 48px;\n  width: 48px;\n  right: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-transparent-overlay {\n  position: fixed;\n  z-index: 2147483647;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-product-modal {\n  position: fixed;\n  z-index: 1000000000;\n  height: 100%;\n  width: 100vw;\n  top: 0px;\n  left: 0px;\n  display: none;\n  overscroll-behavior: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.5);\n}\n  ",document.head.appendChild(q);const F=window.document.getElementById("livesell-meeting-modal"),K=window.document.getElementById("livesell-draggable-overlay"),Q=window.document.getElementById("livesell-resizable-overlay"),ee=window.document.getElementById("livesell-transparent-overlay");let te=null,ne=null;window.addEventListener(_.MESSAGE,n=>{if(n.origin!==G)return;const i=n.data;switch(i.actionType){case U.DRAG_START:r(i.mouseX,i.mouseY);break;case U.DRAG_MOUSEMOVE:c(i.offsetX,i.offsetY);break;case U.DRAG_END:a();break;case U.PRODUCT_PAGE:l(i);break;case U.DATA_ATTRIBUTES:o(i)}n.data.fullscreen?e():!1===n.data.fullscreen&&t()});let ie,oe,le,de,se,re,ae=0,ce=10,ue=window.innerWidth,me=window.innerHeight,he=!1})();
