(function(){function e(e){e.action===D.CONNECT&&(J=e.roomData,I.contentWindow.postMessage({code:e.code,dataAttributes:M},W))}function t(e){if(!M.supportFloatingVideo&&!I.src)return;const t=window.document.getElementById("livesell-product-modal"),o=window.document.getElementById("livesell-product-iframe");e.action===D.OPEN?(o.src=e.url,t.style.display="flex",Y.classList.add("livesell-floating-modal"),J&&J.branding.roomBackgroundColor&&(P.style.background=J.branding.roomBackgroundColor),Y.style.width=`${H.width}px`,Y.style.height=`${H.height}px`,I.style.width="100%",I.style.height="100%",Y.style.bottom="10px",Y.style.left="10px",e.options&&e.options.addDraggableOverlay&&n(),h(),A()):(M.keepProductVisible||(t.style.display="none",o.src=""),Y.classList.remove("livesell-floating-modal"),Y.style.width=null,Y.style.height=null,Y.style.top=null,Y.style.bottom="0px",Y.style.left="0px",I.style.width=null,I.style.height=null,i(),f(),T())}function n(){$.style.display="flex",$.addEventListener("touchend",l),$.addEventListener("touchmove",r),$.addEventListener("touchstart",s)}function i(){$.style.display="none",$.removeEventListener("touchend",l),$.removeEventListener("touchmove",r),$.removeEventListener("touchstart",s)}function o(e,t){Y&&(ne=Y.offsetTop,ie=Y.offsetLeft,Z=ie+e,q=ne+t)}function l(){}function d(e,t){Z&&q&&(ne+=t,ie+=e,c(ne,ie),Z+=e,q+=t)}function s(e){e.preventDefault(),Y&&(Z=e.touches[0].clientX,q=e.touches[0].clientY,ne=Y.offsetTop,ie=Y.offsetLeft)}function r(e){a(e.touches[0])}function a(e){ie+=e.clientX-Z,ne+=e.clientY-q,c(ne,ie),Z=e.clientX,q=e.clientY}function c(e,t){const n=m(e),i=u(t);ne=n,ie=i,Y.style.bottom=window.innerHeight-n-Y.offsetHeight+"px",Y.style.left=i+"px"}function u(e){return Math.max(Math.min(e,window.innerWidth-Y.offsetWidth/2),-Y.offsetWidth/2)}function m(e){return Math.max(Math.min(e,window.innerHeight-Y.offsetHeight/2),-Y.offsetHeight/2)}function h(){window.addEventListener("resize",p)}function f(){window.removeEventListener("resize",p)}function p(e){if(!ne||!ie)return;const t=ne*(window.innerHeight-Y.offsetHeight)/(le-Y.offsetHeight),n=ie*(window.innerWidth-Y.offsetWidth)/(oe-Y.offsetWidth);c(t,n),le=window.innerHeight,oe=window.innerWidth}function v(e){de=!0,K=e.clientX,Q=e.clientY,ee=Y.offsetWidth,te=Y.offsetHeight,F.style.display="flex",document.addEventListener("mousemove",w),document.addEventListener("mouseup",x),j.addEventListener("touchmove",y),j.addEventListener("touchend",x)}function g(e){const t=ee+e.clientX-K,n=t/O;E(t,n)&&(Y.style.width=t+"px",Y.style.height=n+"px")}function E(e,t){return e>H.minWidth&&t>H.minHeight&&e<H.maxWidth&&t<H.maxHeight&&e<window.innerWidth&&t<window.innerHeight&&e/2>-Y.offsetLeft}function w(e){e.preventDefault(),g(e)}function y(e){e.preventDefault(),g(e.touches[0])}function x(e){de=!1,F.style.display="none",document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",w),j.addEventListener("touchend",x),j.removeEventListener("touchmove",y)}function L(e){e.preventDefault(),v(e.touches[0])}function b(e){e.preventDefault(),v(e)}function A(){j.style.display="flex",j.addEventListener("mousedown",b),j.addEventListener("touchstart",L)}function T(){j.style.display="none",j.removeEventListener("mousedown",b),j.removeEventListener("touchstart",L)}const O=16/9,R={PRODUCT_PAGE:"PRODUCT_PAGE",DRAG_START:"LIVESELL_DRAG_START",DRAG_MOUSEMOVE:"LIVESELL_DRAG_MOUSEMOVE",DRAG_END:"LIVESELL_DRAG_END",DATA_ATTRIBUTES:"LIVESELL_DATA_ATTRIBUTES"},D={OPEN:"OPEN",CLOSE:"CLOSE",CONNECT:"CONNECT"},S={MESSAGE:"message",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove",MOUSELEAVE:"mouseleave",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",RESIZE:"resize"},C=window.matchMedia("only screen and (max-width: 760px)").matches,H=C?{minWidth:160,minHeight:90,width:240,height:135,maxWidth:320,maxHeight:180}:{minWidth:240,minHeight:135,width:320,height:180,maxWidth:640,maxHeight:360},U=document.currentScript,M={meetingURL:U.getAttribute("data-livesell-url"),supportFloatingVideo:"true"===U.getAttribute("data-support-floating-video"),keepProductVisible:"true"===U.getAttribute("data-keep-product-visible")};if(!M.meetingURL)return void console.error("ERROR: Please provide meeting URL in livesell integration script.");const _=M.meetingURL,W=new URL(_).origin,N=document.createElement("div");N.style.position="relative";const z=document.createElement("div");z.id="livesell-transparent-overlay",N.appendChild(z);const G=document.createElement("div");G.id="livesell-meeting-modal";const I=document.createElement("iframe");I.id="livesell-meeting-iframe",I.setAttribute("allow","camera; microphone; fullscreen; autoplay"),I.frameBorder="0",G.appendChild(I);const V=document.createElement("div");V.id="livesell-draggable-overlay",G.appendChild(V);const B=document.createElement("div");B.id="livesell-resizable-overlay",G.appendChild(B),N.appendChild(G);const P=document.createElement("div");P.id="livesell-product-modal",N.appendChild(P);const k=document.createElement("iframe");k.id="livesell-product-iframe",k.style.width="100%",k.style.height="100%",k.style.border="none",k.style.overflow="hidden",k.setAttribute("allowfullscreen",""),k.setAttribute("allow",""),k.frameBorder="0",P.appendChild(k),document.body.appendChild(N);const X=document.createElement("style");X.innerHTML="\n  #livesell-meeting-modal {\n  position: fixed;\n  z-index: 2147483646;\n  height: 100%;\n  width: 100vw;\n  bottom: 0px;\n  left: 0px;\n  display: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.5);\n  will-change: transform;\n}\n\n.livesell-floating-modal {\n  left: 10px;\n  bottom: 10px;\n  border-radius: 6px !important;\n  overflow: hidden !important;\n}\n\n#livesell-meeting-iframe {\n  position: relative;\n  z-index: 2147483645;\n  border-radius: 6px;\n  overflow: hidden;\n  height: calc(100% - 32px);\n  width: calc(100% - 32px);\n}\n\n#livesell-draggable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 100%;\n  width: calc(100% - 110px);\n  display: none;\n  cursor: move;\n}\n\n#livesell-resizable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 48px;\n  width: 48px;\n  right: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-transparent-overlay {\n  position: fixed;\n  z-index: 2147483647;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-product-modal {\n  position: fixed;\n  z-index: 1000000000;\n  height: 100%;\n  width: 100vw;\n  top: 0px;\n  left: 0px;\n  display: none;\n  overscroll-behavior: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.5);\n}\n  ",document.head.appendChild(X);const Y=window.document.getElementById("livesell-meeting-modal"),$=window.document.getElementById("livesell-draggable-overlay"),j=window.document.getElementById("livesell-resizable-overlay"),F=window.document.getElementById("livesell-transparent-overlay");let J=null;window.addEventListener(S.MESSAGE,n=>{if(n.origin!==W)return;const i=n.data;switch(i.actionType){case R.DRAG_START:o(i.mouseX,i.mouseY);break;case R.DRAG_MOUSEMOVE:d(i.offsetX,i.offsetY);break;case R.DRAG_END:l();break;case R.PRODUCT_PAGE:t(i);break;case R.DATA_ATTRIBUTES:e(i)}n.data.fullscreen?(I.src=`${_}?autoJoin=true&userName=${n.data.userName}`,Y.style.display="flex",document.body.style.overflow="hidden"):!1===n.data.fullscreen&&(document.body.style.overflow=null,Y.style.display="none",I.src="")});let Z,q,K,Q,ee,te,ne=0,ie=10,oe=window.innerWidth,le=window.innerHeight,de=!1})();
