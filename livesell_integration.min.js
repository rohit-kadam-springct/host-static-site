(function(){function e(e){ie=e?P.smallDevice:P.largeDevice}function t(e){Y.src=`${z}?autoJoin=true&userName=${e.data.userName}&avatar=${e.data.avatar}`,F.style.display="flex",document.body.style.overflow="hidden"}function n(){document.body.style.overflow=null,F.style.display="none",Y.src="",i()}function i(){B.onclick=null}function o(){B.style.userSelect="none",B.style.cursor="pointer",B.onclick=(e=>{e.stopPropagation(),e.preventDefault(),n()})}function l(e){e.action===_.CONNECT&&(te=e.roomData,Y.contentWindow.postMessage({code:e.code,dataAttributes:k},G),o())}function s(t){if(!Y.src)return;ne&&clearTimeout(ne);const n=window.document.getElementById("livesell-product-modal"),l=window.document.getElementById("livesell-product-iframe");t.action===_.OPEN?(e(t.options.isSmallDevice),l.src=t.url,n.style.display="flex",F.classList.add("livesell-floating-modal"),te&&te.branding.roomBackgroundColor&&(J.style.background=te.branding.roomBackgroundColor),F.style.width=`${ie.width}px`,F.style.height=`${ie.height}px`,Y.style.width="100%",Y.style.height="100%",F.style.bottom="10px",F.style.left="10px",t.options&&t.options.addDraggableOverlay&&d(),g(),S(),i()):(F.classList.remove("livesell-floating-modal"),F.style.width=null,F.style.height=null,F.style.top=null,F.style.bottom="0px",F.style.left="0px",Y.style.width=null,Y.style.height=null,r(),y(),C(),o(),k.keepProductVisible||(ne=setTimeout(()=>{n.style.display="none",l.src=""},U)))}function d(){K.style.display="flex",K.addEventListener("touchend",c),K.addEventListener("touchmove",h),K.addEventListener("touchstart",m)}function r(){K.style.display="none",K.removeEventListener("touchend",c),K.removeEventListener("touchmove",h),K.removeEventListener("touchstart",m)}function a(e,t){F&&(ue=F.offsetTop,me=F.offsetLeft,le=me+e,se=ue+t)}function c(){}function u(e,t){le&&se&&(ue+=t,me+=e,p(ue,me),le+=e,se+=t)}function m(e){e.preventDefault(),F&&(le=e.touches[0].clientX,se=e.touches[0].clientY,ue=F.offsetTop,me=F.offsetLeft)}function h(e){f(e.touches[0])}function f(e){me+=e.clientX-le,ue+=e.clientY-se,p(ue,me),le=e.clientX,se=e.clientY}function p(e,t){const n=E(e),i=v(t);ue=n,me=i,F.style.bottom=window.innerHeight-n-F.offsetHeight+"px",F.style.left=i+"px"}function v(e){return Math.max(Math.min(e,window.innerWidth-F.offsetWidth/2),-F.offsetWidth/2)}function E(e){return Math.max(Math.min(e,window.innerHeight-F.offsetHeight/2),-F.offsetHeight/2)}function g(){window.addEventListener("resize",w)}function y(){window.removeEventListener("resize",w)}function w(e){if(!ue||!me)return;const t=ue*(window.innerHeight-F.offsetHeight)/(fe-F.offsetHeight),n=me*(window.innerWidth-F.offsetWidth)/(he-F.offsetWidth);p(t,n),fe=window.innerHeight,he=window.innerWidth}function L(e){pe=!0,de=e.clientX,re=e.clientY,ae=F.offsetWidth,ce=F.offsetHeight,ee.style.display="flex",document.addEventListener("mousemove",A),document.addEventListener("mouseup",D),Q.addEventListener("touchmove",T),Q.addEventListener("touchend",D)}function x(e){const t=ae+e.clientX-de,n=t/H;b(t,n)&&(F.style.width=t+"px",F.style.height=n+"px")}function b(e,t){return e>ie.minWidth&&t>ie.minHeight&&e<ie.maxWidth&&t<ie.maxHeight&&e<window.innerWidth&&t<window.innerHeight&&e/2>-F.offsetLeft}function A(e){e.preventDefault(),x(e)}function T(e){e.preventDefault(),x(e.touches[0])}function D(e){pe=!1,ee.style.display="none",document.removeEventListener("mouseup",D),document.removeEventListener("mousemove",A),Q.addEventListener("touchend",D),Q.removeEventListener("touchmove",T)}function R(e){e.preventDefault(),L(e.touches[0])}function O(e){e.preventDefault(),L(e)}function S(){Q.style.display="flex",Q.addEventListener("mousedown",O),Q.addEventListener("touchstart",R)}function C(){Q.style.display="none",Q.removeEventListener("mousedown",O),Q.removeEventListener("touchstart",R)}const H=16/9,U=1e3,M={PRODUCT_PAGE:"PRODUCT_PAGE",DRAG_START:"LIVESELL_DRAG_START",DRAG_MOUSEMOVE:"LIVESELL_DRAG_MOUSEMOVE",DRAG_END:"LIVESELL_DRAG_END",DATA_ATTRIBUTES:"LIVESELL_DATA_ATTRIBUTES"},_={OPEN:"OPEN",CLOSE:"CLOSE",CONNECT:"CONNECT"},N={MESSAGE:"message",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove",MOUSELEAVE:"mouseleave",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",RESIZE:"resize"},W={PARENT:"parent",LIVESELL:"livesell"},P={smallDevice:{minWidth:160,minHeight:90,width:240,height:135,maxWidth:320,maxHeight:180},largeDevice:{minWidth:240,minHeight:135,width:320,height:180,maxWidth:640,maxHeight:360}},I=document.currentScript,k={meetingURL:I.getAttribute("data-livesell-url"),keepProductVisible:"false"!==I.getAttribute("data-keep-product-visible"),displayProductIframe:I.getAttribute("data-display-product-iframe")||W.PARENT};if(!k.meetingURL)return void console.error("ERROR: Please provide meeting URL in livesell integration script.");const z=k.meetingURL,G=new URL(z).origin,B=document.createElement("div");B.style.position="relative";const V=document.createElement("div");V.id="livesell-transparent-overlay",B.appendChild(V);const X=document.createElement("div");X.id="livesell-meeting-modal";const Y=document.createElement("iframe");Y.id="livesell-meeting-iframe",Y.setAttribute("allow","camera; microphone; fullscreen; autoplay"),Y.frameBorder="0",X.appendChild(Y);const $=document.createElement("div");$.id="livesell-draggable-overlay",X.appendChild($);const j=document.createElement("div");j.id="livesell-resizable-overlay",X.appendChild(j),B.appendChild(X);const J=document.createElement("div");J.id="livesell-product-modal",B.appendChild(J);const Z=document.createElement("iframe");Z.id="livesell-product-iframe",Z.style.width="100%",Z.style.height="100%",Z.style.border="none",Z.style.overflow="hidden",Z.setAttribute("allowfullscreen",""),Z.setAttribute("allow",""),Z.frameBorder="0",J.appendChild(Z),document.body.appendChild(B);const q=document.createElement("style");q.innerHTML="\n  #livesell-meeting-modal {\n  position: fixed;\n  z-index: 2147483646;\n  height: 100%;\n  width: 100vw;\n  bottom: 0px;\n  left: 0px;\n  display: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.9);\n  will-change: transform;\n}\n\n.livesell-floating-modal {\n  left: 10px;\n  bottom: 10px;\n  border-radius: 6px !important;\n  overflow: hidden !important;\n}\n\n#livesell-meeting-iframe {\n  position: relative;\n  z-index: 2147483645;\n  border-radius: 6px;\n  overflow: hidden;\n  height: calc(100% - 32px);\n  width: calc(100% - 32px);\n}\n\n#livesell-draggable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 100%;\n  width: calc(100% - 110px);\n  display: none;\n  cursor: move;\n}\n\n#livesell-resizable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 48px;\n  width: 48px;\n  right: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-transparent-overlay {\n  position: fixed;\n  z-index: 2147483647;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-product-modal {\n  position: fixed;\n  z-index: 1000000000;\n  height: 100%;\n  width: 100vw;\n  top: 0px;\n  left: 0px;\n  display: none;\n  overscroll-behavior: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.9);\n}\n  ",document.head.appendChild(q);const F=window.document.getElementById("livesell-meeting-modal"),K=window.document.getElementById("livesell-draggable-overlay"),Q=window.document.getElementById("livesell-resizable-overlay"),ee=window.document.getElementById("livesell-transparent-overlay");let te=null,ne=null,ie=null;const oe=window.matchMedia("only screen and (max-width: 760px)").matches;e(oe),window.addEventListener(N.MESSAGE,e=>{if(e.origin!==G)return;const i=e.data;switch(i.actionType){case M.DRAG_START:a(i.mouseX,i.mouseY);break;case M.DRAG_MOUSEMOVE:u(i.offsetX,i.offsetY);break;case M.DRAG_END:c();break;case M.PRODUCT_PAGE:s(i);break;case M.DATA_ATTRIBUTES:l(i)}e.data.fullscreen?t(e):!1===e.data.fullscreen&&n()});let le,se,de,re,ae,ce,ue=0,me=10,he=window.innerWidth,fe=window.innerHeight,pe=!1})();
