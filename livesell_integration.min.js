(function(){function e(){X.src=`${k}?autoJoin=true&userName=${event.data.userName}`,q.style.display="flex",document.body.style.overflow="hidden"}function t(){document.body.style.overflow=null,q.style.display="none",X.src="",G.onclick=null}function n(){G.style.userSelect="none",G.style.cursor="pointer",G.onclick=(e=>{e.stopPropagation(),e.preventDefault(),t()})}function i(e){e.action===U.CONNECT&&(ee=e.roomData,X.contentWindow.postMessage({code:e.code,dataAttributes:I},z),n())}function o(e){if(!X.src)return;te&&clearTimeout(te);const t=window.document.getElementById("livesell-product-modal"),n=window.document.getElementById("livesell-product-iframe");e.action===U.OPEN?(n.src=e.url,t.style.display="flex",q.classList.add("livesell-floating-modal"),ee&&ee.branding.roomBackgroundColor&&(j.style.background=ee.branding.roomBackgroundColor),q.style.width=`${W.width}px`,q.style.height=`${W.height}px`,X.style.width="100%",X.style.height="100%",q.style.bottom="10px",q.style.left="10px",e.options&&e.options.addDraggableOverlay&&l(),v(),O()):(q.classList.remove("livesell-floating-modal"),q.style.width=null,q.style.height=null,q.style.top=null,q.style.bottom="0px",q.style.left="0px",X.style.width=null,X.style.height=null,d(),E(),D(),I.keepProductVisible||(te=setTimeout(()=>{t.style.display="none",n.src=""},C)))}function l(){F.style.display="flex",F.addEventListener("touchend",r),F.addEventListener("touchmove",u),F.addEventListener("touchstart",c)}function d(){F.style.display="none",F.removeEventListener("touchend",r),F.removeEventListener("touchmove",u),F.removeEventListener("touchstart",c)}function s(e,t){q&&(re=q.offsetTop,ae=q.offsetLeft,ne=ae+e,ie=re+t)}function r(){}function a(e,t){ne&&ie&&(re+=t,ae+=e,h(re,ae),ne+=e,ie+=t)}function c(e){e.preventDefault(),q&&(ne=e.touches[0].clientX,ie=e.touches[0].clientY,re=q.offsetTop,ae=q.offsetLeft)}function u(e){m(e.touches[0])}function m(e){ae+=e.clientX-ne,re+=e.clientY-ie,h(re,ae),ne=e.clientX,ie=e.clientY}function h(e,t){const n=p(e),i=f(t);re=n,ae=i,q.style.bottom=window.innerHeight-n-q.offsetHeight+"px",q.style.left=i+"px"}function f(e){return Math.max(Math.min(e,window.innerWidth-q.offsetWidth/2),-q.offsetWidth/2)}function p(e){return Math.max(Math.min(e,window.innerHeight-q.offsetHeight/2),-q.offsetHeight/2)}function v(){window.addEventListener("resize",g)}function E(){window.removeEventListener("resize",g)}function g(e){if(!re||!ae)return;const t=re*(window.innerHeight-q.offsetHeight)/(ue-q.offsetHeight),n=ae*(window.innerWidth-q.offsetWidth)/(ce-q.offsetWidth);h(t,n),ue=window.innerHeight,ce=window.innerWidth}function y(e){me=!0,oe=e.clientX,le=e.clientY,de=q.offsetWidth,se=q.offsetHeight,Q.style.display="flex",document.addEventListener("mousemove",x),document.addEventListener("mouseup",A),K.addEventListener("touchmove",b),K.addEventListener("touchend",A)}function w(e){const t=de+e.clientX-oe,n=t/S;L(t,n)&&(q.style.width=t+"px",q.style.height=n+"px")}function L(e,t){return e>W.minWidth&&t>W.minHeight&&e<W.maxWidth&&t<W.maxHeight&&e<window.innerWidth&&t<window.innerHeight&&e/2>-q.offsetLeft}function x(e){e.preventDefault(),w(e)}function b(e){e.preventDefault(),w(e.touches[0])}function A(e){me=!1,Q.style.display="none",document.removeEventListener("mouseup",A),document.removeEventListener("mousemove",x),K.addEventListener("touchend",A),K.removeEventListener("touchmove",b)}function T(e){e.preventDefault(),y(e.touches[0])}function R(e){e.preventDefault(),y(e)}function O(){K.style.display="flex",K.addEventListener("mousedown",R),K.addEventListener("touchstart",T)}function D(){K.style.display="none",K.removeEventListener("mousedown",R),K.removeEventListener("touchstart",T)}const S=16/9,C=1e3,H={PRODUCT_PAGE:"PRODUCT_PAGE",DRAG_START:"LIVESELL_DRAG_START",DRAG_MOUSEMOVE:"LIVESELL_DRAG_MOUSEMOVE",DRAG_END:"LIVESELL_DRAG_END",DATA_ATTRIBUTES:"LIVESELL_DATA_ATTRIBUTES"},U={OPEN:"OPEN",CLOSE:"CLOSE",CONNECT:"CONNECT"},M={MESSAGE:"message",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove",MOUSELEAVE:"mouseleave",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",RESIZE:"resize"},_={PARENT:"parent",LIVESELL:"livesell"},N=window.matchMedia("only screen and (max-width: 760px)").matches,W=N?{minWidth:160,minHeight:90,width:240,height:135,maxWidth:320,maxHeight:180}:{minWidth:240,minHeight:135,width:320,height:180,maxWidth:640,maxHeight:360},P=document.currentScript,I={meetingURL:P.getAttribute("data-livesell-url"),keepProductVisible:"false"!==P.getAttribute("data-keep-product-visible"),displayProductIframe:P.getAttribute("data-display-product-iframe")||_.PARENT};if(!I.meetingURL)return void console.error("ERROR: Please provide meeting URL in livesell integration script.");const k=I.meetingURL,z=new URL(k).origin,G=document.createElement("div");G.style.position="relative";const B=document.createElement("div");B.id="livesell-transparent-overlay",G.appendChild(B);const V=document.createElement("div");V.id="livesell-meeting-modal";const X=document.createElement("iframe");X.id="livesell-meeting-iframe",X.setAttribute("allow","camera; microphone; fullscreen; autoplay"),X.frameBorder="0",V.appendChild(X);const Y=document.createElement("div");Y.id="livesell-draggable-overlay",V.appendChild(Y);const $=document.createElement("div");$.id="livesell-resizable-overlay",V.appendChild($),G.appendChild(V);const j=document.createElement("div");j.id="livesell-product-modal",G.appendChild(j);const J=document.createElement("iframe");J.id="livesell-product-iframe",J.style.width="100%",J.style.height="100%",J.style.border="none",J.style.overflow="hidden",J.setAttribute("allowfullscreen",""),J.setAttribute("allow",""),J.frameBorder="0",j.appendChild(J),document.body.appendChild(G);const Z=document.createElement("style");Z.innerHTML="\n  #livesell-meeting-modal {\n  position: fixed;\n  z-index: 2147483646;\n  height: 100%;\n  width: 100vw;\n  bottom: 0px;\n  left: 0px;\n  display: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.5);\n  will-change: transform;\n}\n\n.livesell-floating-modal {\n  left: 10px;\n  bottom: 10px;\n  border-radius: 6px !important;\n  overflow: hidden !important;\n}\n\n#livesell-meeting-iframe {\n  position: relative;\n  z-index: 2147483645;\n  border-radius: 6px;\n  overflow: hidden;\n  height: calc(100% - 32px);\n  width: calc(100% - 32px);\n}\n\n#livesell-draggable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 100%;\n  width: calc(100% - 110px);\n  display: none;\n  cursor: move;\n}\n\n#livesell-resizable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 48px;\n  width: 48px;\n  right: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-transparent-overlay {\n  position: fixed;\n  z-index: 2147483647;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-product-modal {\n  position: fixed;\n  z-index: 1000000000;\n  height: 100%;\n  width: 100vw;\n  top: 0px;\n  left: 0px;\n  display: none;\n  overscroll-behavior: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.5);\n}\n  ",document.head.appendChild(Z);const q=window.document.getElementById("livesell-meeting-modal"),F=window.document.getElementById("livesell-draggable-overlay"),K=window.document.getElementById("livesell-resizable-overlay"),Q=window.document.getElementById("livesell-transparent-overlay");let ee=null,te=null;window.addEventListener(M.MESSAGE,n=>{if(n.origin!==z)return;const l=n.data;switch(l.actionType){case H.DRAG_START:s(l.mouseX,l.mouseY);break;case H.DRAG_MOUSEMOVE:a(l.offsetX,l.offsetY);break;case H.DRAG_END:r();break;case H.PRODUCT_PAGE:o(l);break;case H.DATA_ATTRIBUTES:i(l)}n.data.fullscreen?e():!1===n.data.fullscreen&&t()});let ne,ie,oe,le,de,se,re=0,ae=10,ce=window.innerWidth,ue=window.innerHeight,me=!1})();
