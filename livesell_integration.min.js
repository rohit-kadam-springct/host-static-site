(function(){function e(e){e.action===S.CONNECT&&(Z=e.roomData,V.contentWindow.postMessage({code:e.code,dataAttributes:_},N))}function t(e){if(!_.supportFloatingVideo&&!V.src)return;q&&clearTimeout(q);const t=window.document.getElementById("livesell-product-modal"),o=window.document.getElementById("livesell-product-iframe");e.action===S.OPEN?(o.src=e.url,t.style.display="flex",$.classList.add("livesell-floating-modal"),Z&&Z.branding.roomBackgroundColor&&(k.style.background=Z.branding.roomBackgroundColor),$.style.width=`${U.width}px`,$.style.height=`${U.height}px`,V.style.width="100%",V.style.height="100%",$.style.bottom="10px",$.style.left="10px",e.options&&e.options.addDraggableOverlay&&n(),h(),A()):($.classList.remove("livesell-floating-modal"),$.style.width=null,$.style.height=null,$.style.top=null,$.style.bottom="0px",$.style.left="0px",V.style.width=null,V.style.height=null,i(),f(),T(),_.keepProductVisible||(q=setTimeout(()=>{t.style.display="none",o.src=""},R)))}function n(){j.style.display="flex",j.addEventListener("touchend",l),j.addEventListener("touchmove",r),j.addEventListener("touchstart",s)}function i(){j.style.display="none",j.removeEventListener("touchend",l),j.removeEventListener("touchmove",r),j.removeEventListener("touchstart",s)}function o(e,t){$&&(oe=$.offsetTop,le=$.offsetLeft,K=le+e,Q=oe+t)}function l(){}function d(e,t){K&&Q&&(oe+=t,le+=e,c(oe,le),K+=e,Q+=t)}function s(e){e.preventDefault(),$&&(K=e.touches[0].clientX,Q=e.touches[0].clientY,oe=$.offsetTop,le=$.offsetLeft)}function r(e){a(e.touches[0])}function a(e){le+=e.clientX-K,oe+=e.clientY-Q,c(oe,le),K=e.clientX,Q=e.clientY}function c(e,t){const n=m(e),i=u(t);oe=n,le=i,$.style.bottom=window.innerHeight-n-$.offsetHeight+"px",$.style.left=i+"px"}function u(e){return Math.max(Math.min(e,window.innerWidth-$.offsetWidth/2),-$.offsetWidth/2)}function m(e){return Math.max(Math.min(e,window.innerHeight-$.offsetHeight/2),-$.offsetHeight/2)}function h(){window.addEventListener("resize",p)}function f(){window.removeEventListener("resize",p)}function p(e){if(!oe||!le)return;const t=oe*(window.innerHeight-$.offsetHeight)/(se-$.offsetHeight),n=le*(window.innerWidth-$.offsetWidth)/(de-$.offsetWidth);c(t,n),se=window.innerHeight,de=window.innerWidth}function v(e){re=!0,ee=e.clientX,te=e.clientY,ne=$.offsetWidth,ie=$.offsetHeight,J.style.display="flex",document.addEventListener("mousemove",w),document.addEventListener("mouseup",x),F.addEventListener("touchmove",y),F.addEventListener("touchend",x)}function g(e){const t=ne+e.clientX-ee,n=t/O;E(t,n)&&($.style.width=t+"px",$.style.height=n+"px")}function E(e,t){return e>U.minWidth&&t>U.minHeight&&e<U.maxWidth&&t<U.maxHeight&&e<window.innerWidth&&t<window.innerHeight&&e/2>-$.offsetLeft}function w(e){e.preventDefault(),g(e)}function y(e){e.preventDefault(),g(e.touches[0])}function x(e){re=!1,J.style.display="none",document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",w),F.addEventListener("touchend",x),F.removeEventListener("touchmove",y)}function L(e){e.preventDefault(),v(e.touches[0])}function b(e){e.preventDefault(),v(e)}function A(){F.style.display="flex",F.addEventListener("mousedown",b),F.addEventListener("touchstart",L)}function T(){F.style.display="none",F.removeEventListener("mousedown",b),F.removeEventListener("touchstart",L)}const O=16/9,R=1e3,D={PRODUCT_PAGE:"PRODUCT_PAGE",DRAG_START:"LIVESELL_DRAG_START",DRAG_MOUSEMOVE:"LIVESELL_DRAG_MOUSEMOVE",DRAG_END:"LIVESELL_DRAG_END",DATA_ATTRIBUTES:"LIVESELL_DATA_ATTRIBUTES"},S={OPEN:"OPEN",CLOSE:"CLOSE",CONNECT:"CONNECT"},C={MESSAGE:"message",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove",MOUSELEAVE:"mouseleave",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",RESIZE:"resize"},H=window.matchMedia("only screen and (max-width: 760px)").matches,U=H?{minWidth:160,minHeight:90,width:240,height:135,maxWidth:320,maxHeight:180}:{minWidth:240,minHeight:135,width:320,height:180,maxWidth:640,maxHeight:360},M=document.currentScript,_={meetingURL:M.getAttribute("data-livesell-url"),supportFloatingVideo:"true"===M.getAttribute("data-support-floating-video"),keepProductVisible:"true"===M.getAttribute("data-keep-product-visible")};if(!_.meetingURL)return void console.error("ERROR: Please provide meeting URL in livesell integration script.");const W=_.meetingURL,N=new URL(W).origin,z=document.createElement("div");z.style.position="relative";const G=document.createElement("div");G.id="livesell-transparent-overlay",z.appendChild(G);const I=document.createElement("div");I.id="livesell-meeting-modal";const V=document.createElement("iframe");V.id="livesell-meeting-iframe",V.setAttribute("allow","camera; microphone; fullscreen; autoplay"),V.frameBorder="0",I.appendChild(V);const B=document.createElement("div");B.id="livesell-draggable-overlay",I.appendChild(B);const P=document.createElement("div");P.id="livesell-resizable-overlay",I.appendChild(P),z.appendChild(I);const k=document.createElement("div");k.id="livesell-product-modal",z.appendChild(k);const X=document.createElement("iframe");X.id="livesell-product-iframe",X.style.width="100%",X.style.height="100%",X.style.border="none",X.style.overflow="hidden",X.setAttribute("allowfullscreen",""),X.setAttribute("allow",""),X.frameBorder="0",k.appendChild(X),document.body.appendChild(z);const Y=document.createElement("style");Y.innerHTML="\n  #livesell-meeting-modal {\n  position: fixed;\n  z-index: 2147483646;\n  height: 100%;\n  width: 100vw;\n  bottom: 0px;\n  left: 0px;\n  display: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.5);\n  will-change: transform;\n}\n\n.livesell-floating-modal {\n  left: 10px;\n  bottom: 10px;\n  border-radius: 6px !important;\n  overflow: hidden !important;\n}\n\n#livesell-meeting-iframe {\n  position: relative;\n  z-index: 2147483645;\n  border-radius: 6px;\n  overflow: hidden;\n  height: calc(100% - 32px);\n  width: calc(100% - 32px);\n}\n\n#livesell-draggable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 100%;\n  width: calc(100% - 110px);\n  display: none;\n  cursor: move;\n}\n\n#livesell-resizable-overlay {\n  position: absolute;\n  z-index: 2147483647;\n  height: 48px;\n  width: 48px;\n  right: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-transparent-overlay {\n  position: fixed;\n  z-index: 2147483647;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  display: none;\n  cursor: nesw-resize;\n}\n\n#livesell-product-modal {\n  position: fixed;\n  z-index: 1000000000;\n  height: 100%;\n  width: 100vw;\n  top: 0px;\n  left: 0px;\n  display: none;\n  overscroll-behavior: none;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.5);\n}\n  ",document.head.appendChild(Y);const $=window.document.getElementById("livesell-meeting-modal"),j=window.document.getElementById("livesell-draggable-overlay"),F=window.document.getElementById("livesell-resizable-overlay"),J=window.document.getElementById("livesell-transparent-overlay");let Z=null,q=null;window.addEventListener(C.MESSAGE,n=>{if(n.origin!==N)return;const i=n.data;switch(i.actionType){case D.DRAG_START:o(i.mouseX,i.mouseY);break;case D.DRAG_MOUSEMOVE:d(i.offsetX,i.offsetY);break;case D.DRAG_END:l();break;case D.PRODUCT_PAGE:t(i);break;case D.DATA_ATTRIBUTES:e(i)}n.data.fullscreen?(V.src=`${W}?autoJoin=true&userName=${n.data.userName}`,$.style.display="flex",document.body.style.overflow="hidden"):!1===n.data.fullscreen&&(document.body.style.overflow=null,$.style.display="none",V.src="")});let K,Q,ee,te,ne,ie,oe=0,le=10,de=window.innerWidth,se=window.innerHeight,re=!1})();
