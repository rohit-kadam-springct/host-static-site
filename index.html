<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveSell Iframe</title>
    <style>
      html {
        margin: 0;
        padding: 0;
        height: 100vh;
      }

      body {
        margin: 0;
        padding: 0;
        height: 100%;
        max-height: 100%;
        float: left;
        width: 100%;
        position: relative; /* Or any other positioning you need */
        /* overflow: hidden; */
      }
    </style>
 
     <!-- Styles  -->

     <style>    
      #livesell-meeting-modal {
        position: fixed;
        z-index: 2147483647;
        height: 100%;
        width: 100vw;
        bottom: 0px;
        left: 0px;
        display: none;
        overscroll-behavior: none;
        justify-content: center;
        align-items: center;
        background: rgba(0, 0, 0, 0.5);
      }

      .livesell-floating-modal {
        width: 320px !important;
        height: 180px !important;
        left: 10px !important;
        bottom: 10px !important;
        border-radius: 6px !important;
        overflow: hidden !important;
      }
      
      #livesell-meeting-iframe {
        position: relative;
        z-index: 2147483646;
        border-radius: 6px;
        overflow: hidden;
        height: calc(100% - 32px); 
        width: calc(100% - 32px);
      }

      #livesell-product-modal {
        position: fixed;
        z-index: 1000000000;
        height: 100%;
        width: 100vw;
        top: 0px;
        left: 0px;
        display: none;
        overscroll-behavior: none;
        justify-content: center;
        align-items: center;
        background: rgba(0, 0, 0, 0.5);
      }

    </style>
  
    <script>

      // Event listener to receive messages from the livesell meeting iframe
      let eventListener = window.addEventListener('message', (event) => {
        const MEETING_URL = "https://rohitkadam.oghanna.com/xsi-waqu-zog"
        const LIVESELL_MEETING_ORIGIN = new URL(MEETING_URL).origin

        if(event.origin !== LIVESELL_MEETING_ORIGIN) return 

        const meetingModal = window.document.getElementById('livesell-meeting-modal');
        const meetingIframe = window.document.getElementById("livesell-meeting-iframe");
        
        if(event.data.actionType === "CHECKOUT_PAGE") {
          const productModalEle = window.document.getElementById('livesell-product-modal');
          const productIframe = window.document.getElementById("livesell-checkout-iframe");
          
          if(event.data.action === "OPEN") {
            meetingIframe.contentWindow.postMessage({data: "server", code: event.data.code}, LIVESELL_MEETING_ORIGIN)
            productIframe.src = event.data.url
            productModalEle.style.display = "flex"
            meetingModal.classList.add("livesell-floating-modal")
            meetingIframe.style.width = "100%"
            meetingIframe.style.height = "100%"
          } 
          else {
            productModalEle.style.display = "none"
            meetingModal.classList.remove("livesell-floating-modal")
            meetingIframe.style.width = null
            meetingIframe.style.height = null
          }
          return
        }

        if(event.data.fullscreen) {
          meetingIframe.src = `${MEETING_URL}?autoJoin=true&userName=${event.data.userName}`
          meetingModal.style.display = "flex"
          document.body.style.overflow = "hidden"
        } 
        else if(event.data.fullscreen === false) {
          document.body.style.overflow = null // UPDATE TO: Parent site overlay property
          meetingModal.style.display = "none"
          meetingIframe.src = ""
        }
      });

    </script>

  </head>
  <body >
    <main>
      <div style="width: 100%; height: 200px; background-color: blueviolet"></div>

      <iframe
            width="100%"
            height="550px"
            allow="camera; microphone; fullscreen"
            src="https://rohitkadam.oghanna.com/xsi-waqu-zog?iframe=true"
            frameborder="0"
            allowfullscreen=""
          >
      </iframe>
      
      <div style="width: 100%; height: 200px; background-color: blueviolet"></div>
    </main>

    <div id="livesell-meeting-modal">
        <iframe id="livesell-meeting-iframe"  allow="camera; microphone; fullscreen" frameborder="0"
        allowfullscreen="">
        </iframe>
    </div>

    <div id="livesell-product-modal">
      <iframe id="livesell-checkout-iframe" width="100%" height="100%" allow="" frameborder="0"
        allowfullscreen="">
      </iframe>
    </div>

    </body>
</html>
